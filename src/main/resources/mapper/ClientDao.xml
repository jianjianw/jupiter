<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.qiein.jupiter.web.dao.ClientDao">

    <update id="editClientBaseInfo" parameterType="map">
        UPDATE
	      ${tabName}
        <set>
            <if test="clientStatusVO.weFlag != null">
                WEFLAG = #{clientStatusVO.weFlag},
            </if>
            <if test="clientStatusVO.sex != null">
                SEX = #{clientStatusVO.sex}
            </if>
        </set>
        WHERE
	      KZID = #{clientStatusVO.kzId} AND COMPANYID = #{clientStatusVO.companyId}
    </update>

    <!-- 快速添加备注标签 -->
    <update id="editClientMemoLabel" parameterType="map">
		UPDATE
		${tabName}
		SET
		MEMO = CONCAT(#{label}, IFNULL(MEMO,''))
		WHERE
		COMPANYID = #{companyId}
		AND KZID = #{kzId};
	</update>

    <!-- 根据状态筛选客资数量 -->
    <select id="getKzNumByStatusId" parameterType="map" resultType="java.lang.Integer">
		SELECT COUNT(1)
		FROM ${tableName} info
		WHERE  info.ISDEL = 0
		AND info.STATUSID = #{statusId}
		AND info.COMPANYID = #{companyId}
	</select>
</mapper>